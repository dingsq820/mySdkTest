(()=>{"use strict";var e={6585:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractAccountAdapter=void 0;const i=s(9527);class r extends i.AbstractAdapter{constructor(e={}){super(e)}}t.AbstractAccountAdapter=r,t.default=r},4193:function(e,t,s){var i,r=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var r=Object.getOwnPropertyDescriptor(t,s);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,r)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&r(t,e,s);return n(t,e),t},a=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))},d=this&&this.__classPrivateFieldSet||function(e,t,s,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,s):r?r.value=s:t.set(e,s),s},c=this&&this.__classPrivateFieldGet||function(e,t,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(e):i?i.value:t.get(e)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccountService=t.SignTypedDataVersion=t.AccountImportStrategy=t.KeyringTypes=void 0;const l=s(9757),h=u(s(267)),p=s(9685),g=s(7567),v=o(s(3158)),f=s(2786);var y,S,w;!function(e){e.simple="Simple Key Pair",e.hd="HD Key Tree",e.qr="QR Hardware Wallet Device"}(y=t.KeyringTypes||(t.KeyringTypes={})),(w=t.AccountImportStrategy||(t.AccountImportStrategy={})).privateKey="privateKey",w.json="json",function(e){e.V1="V1",e.V3="V3",e.V4="V4"}(S=t.SignTypedDataVersion||(t.SignTypedDataVersion={}));class m extends f.AbstractService{constructor(){super(...arguments),this.name="AccountService",this.mutex=new l.Mutex,i.set(this,void 0)}initialize(e,t){d(this,i,new h.default(Object.assign({initState:t},e)),"f"),this.defaultState=Object.assign(Object.assign({},c(this,i,"f").store.getState()),{keyrings:[]}),c(this,i,"f").store.subscribe((e=>{this.updateState(e)})),this.fullUpdate()}addNewAccount(){return a(this,void 0,void 0,(function*(){const e=c(this,i,"f").getKeyringsByType("HD Key Tree")[0];if(!e)throw new Error("No HD keyring found");const t=yield c(this,i,"f").getAccounts();yield c(this,i,"f").addNewAccount(e);const s=yield c(this,i,"f").getAccounts();return yield this.verifySeedPhrase(),this.updateIdentities(s),s.forEach((e=>{t.includes(e)||this.setSelectedAddress(e)})),this.fullUpdate()}))}addNewAccountWithoutUpdate(){return a(this,void 0,void 0,(function*(){const e=c(this,i,"f").getKeyringsByType("HD Key Tree")[0];if(!e)throw new Error("No HD keyring found");return yield c(this,i,"f").addNewAccount(e),yield this.verifySeedPhrase(),this.fullUpdate()}))}createNewVaultAndKeychain(e){return a(this,void 0,void 0,(function*(){const t=yield this.mutex.acquire();try{const t=yield c(this,i,"f").createNewVaultAndKeychain(e);return this.updateIdentities(yield c(this,i,"f").getAccounts()),this.fullUpdate(),t}finally{t()}}))}updateIdentities(e){var t;const s=null===(t=this.manager)||void 0===t?void 0:t.getServiceByName("PreferencesService");s&&s.updateIdentities(e)}setSelectedAddress(e){var t;const s=null===(t=this.manager)||void 0===t?void 0:t.getServiceByName("PreferencesService");s&&s.setSelectedAddress(e)}setAccountLabel(e,t){var s;const i=null===(s=this.manager)||void 0===s?void 0:s.getServiceByName("PreferencesService");i&&i.setAccountLabel(e,t)}removeIdentity(e){var t;const s=null===(t=this.manager)||void 0===t?void 0:t.getServiceByName("PreferencesService");s&&s.removeIdentity(e)}syncIdentities(e){var t;const s=null===(t=this.manager)||void 0===t?void 0:t.getServiceByName("PreferencesService");s&&s.syncIdentities(e)}createNewVaultAndRestore(e,t){return a(this,void 0,void 0,(function*(){const s=yield this.mutex.acquire();if(!e||!e.length)throw new Error("Invalid password");try{this.updateIdentities([]);const s=yield c(this,i,"f").createNewVaultAndRestore(e,t);return this.updateIdentities(yield c(this,i,"f").getAccounts()),this.fullUpdate(),s}finally{s()}}))}validatePassword(e){return c(this,i,"f").password===e}isUnlocked(){return c(this,i,"f").memStore.getState().isUnlocked}exportSeedPhrase(e){if(this.validatePassword(e))return c(this,i,"f").keyrings[0].mnemonic;throw new Error("Invalid password")}exportAccount(e,t){if(this.validatePassword(e))return c(this,i,"f").exportAccount(t);throw new Error("Invalid password")}getAccounts(){return c(this,i,"f").getAccounts()}importAccountWithStrategy(e,t){return a(this,void 0,void 0,(function*(){let s;switch(e){case"privateKey":const[i]=t;if(!i)throw new Error("Cannot import an empty key.");const r=(0,g.addHexPrefix)(i);let n;try{n=(0,g.toBuffer)(r)}catch(e){throw new Error("Cannot import invalid private key.")}if(!(0,g.isValidPrivate)(n))throw new Error("Cannot import invalid private key.");s=(0,g.stripHexPrefix)(r);break;case"json":let o;const[a,d]=t;try{o=v.thirdparty.fromEtherWallet(a,d)}catch(e){o=o||(yield v.default.fromV3(a,d,!0))}s=(0,g.bufferToHex)(o.getPrivateKey());break;default:throw new Error(`Unexpected import strategy: '${e}'`)}const r=yield c(this,i,"f").addNewKeyring(y.simple,[s]),n=yield r.getAccounts(),o=yield c(this,i,"f").getAccounts();return this.updateIdentities(o),this.setSelectedAddress(n[0]),this.fullUpdate()}))}removeAccount(e){return a(this,void 0,void 0,(function*(){return this.removeIdentity(e),yield c(this,i,"f").removeAccount(e),this.fullUpdate()}))}setLocked(){return c(this,i,"f").setLocked()}signMessage(e){return c(this,i,"f").signMessage(e)}signPersonalMessage(e){return c(this,i,"f").signPersonalMessage(e)}signTypedMessage(e,t){return a(this,void 0,void 0,(function*(){try{const s=(0,p.normalize)(e.from),r=yield this.getOrAddQRKeyring();if(-1!==(yield r.getAccounts()).findIndex((e=>e.toLowerCase()===s.toLowerCase()))){const s=Object.assign({},e);return t!==S.V1&&"string"==typeof s.data&&(s.data=JSON.parse(s.data)),c(this,i,"f").signTypedMessage(s,{version:t})}const{password:n}=c(this,i,"f"),o=yield this.exportAccount(n,s),a=(0,g.toBuffer)((0,g.addHexPrefix)(o));switch(t){case S.V1:return(0,p.signTypedDataLegacy)(a,{data:e.data});case S.V3:return(0,p.signTypedData)(a,{data:JSON.parse(e.data)});case S.V4:return(0,p.signTypedData_v4)(a,{data:JSON.parse(e.data)});default:throw new Error(`Unexpected signTypedMessage version: '${t}'`)}}catch(e){throw new Error(`Keyring Controller signTypedMessage: ${e}`)}}))}signTransaction(e,t){return c(this,i,"f").signTransaction(e,t)}submitPassword(e){return a(this,void 0,void 0,(function*(){yield c(this,i,"f").submitPassword(e);const t=yield c(this,i,"f").getAccounts();return yield this.syncIdentities(t),this.fullUpdate()}))}onLock(e){return c(this,i,"f").on("lock",e)}onUnlock(e){return c(this,i,"f").on("unlock",e)}verifySeedPhrase(){return a(this,void 0,void 0,(function*(){const e=c(this,i,"f").getKeyringsByType(y.hd)[0];if(!e)throw new Error("No HD keyring found.");const t=(yield e.serialize()).mnemonic,s=yield e.getAccounts();if(0===s.length)throw new Error("Cannot verify an empty keyring.");const r=new(c(this,i,"f").getKeyringClassForType(y.hd))({mnemonic:t,numberOfAccounts:s.length}),n=yield r.getAccounts();if(n.length!==s.length)throw new Error("Seed phrase imported incorrect number of accounts.");return n.forEach(((e,t)=>{if(e.toLowerCase()!==s[t].toLowerCase())throw new Error("Seed phrase imported different accounts.")})),t}))}fullUpdate(){return a(this,void 0,void 0,(function*(){const e=yield Promise.all(c(this,i,"f").keyrings.map(((e,t)=>a(this,void 0,void 0,(function*(){const s=yield e.getAccounts();return{accounts:Array.isArray(s)?s.map((e=>this.toChecksumHexAddress(e))):[],index:t,type:e.type}})))));return this.updateState({keyrings:[...e]}),c(this,i,"f").fullUpdate()}))}addQRKeyring(){return a(this,void 0,void 0,(function*(){const e=yield c(this,i,"f").addNewKeyring(y.qr);return yield this.fullUpdate(),e}))}getOrAddQRKeyring(){return a(this,void 0,void 0,(function*(){return c(this,i,"f").getKeyringsByType(y.qr)[0]||this.addQRKeyring()}))}restoreQRKeyring(e){return a(this,void 0,void 0,(function*(){(yield this.getOrAddQRKeyring()).deserialize(e),this.updateIdentities(yield c(this,i,"f").getAccounts()),yield this.fullUpdate()}))}resetQRKeyringState(){return a(this,void 0,void 0,(function*(){(yield this.getOrAddQRKeyring()).resetStore()}))}getQRKeyringState(){return a(this,void 0,void 0,(function*(){return(yield this.getOrAddQRKeyring()).getMemStore()}))}submitQRCryptoHDKey(e){return a(this,void 0,void 0,(function*(){(yield this.getOrAddQRKeyring()).submitCryptoHDKey(e)}))}submitQRCryptoAccount(e){return a(this,void 0,void 0,(function*(){(yield this.getOrAddQRKeyring()).submitCryptoAccount(e)}))}submitQRSignature(e,t){return a(this,void 0,void 0,(function*(){(yield this.getOrAddQRKeyring()).submitSignature(e,t)}))}cancelQRSignRequest(){return a(this,void 0,void 0,(function*(){(yield this.getOrAddQRKeyring()).cancelSignRequest()}))}connectQRHardware(e){return a(this,void 0,void 0,(function*(){try{const t=yield this.getOrAddQRKeyring();let s;switch(e){case-1:s=yield t.getPreviousPage();break;case 1:s=yield t.getNextPage();break;default:s=yield t.getFirstPage()}return s.map((e=>Object.assign(Object.assign({},e),{balance:"0x0"})))}catch(e){throw new Error(`Unspecified error when connect QR Hardware, ${e}`)}}))}unlockQRHardwareWalletAccount(e){return a(this,void 0,void 0,(function*(){const t=yield this.getOrAddQRKeyring();t.setAccountToUnlock(e);const s=yield c(this,i,"f").getAccounts();yield c(this,i,"f").addNewAccount(t);const r=yield c(this,i,"f").getAccounts();this.updateIdentities(r),r.forEach((i=>{s.includes(i)||(this.setAccountLabel&&this.setAccountLabel(i,`${t.getName()} ${e}`),this.setSelectedAddress(i))})),yield c(this,i,"f").persistAllKeyrings(),yield this.fullUpdate()}))}getAccountKeyringType(e){return a(this,void 0,void 0,(function*(){return(yield c(this,i,"f").getKeyringForAccount(e)).type}))}forgetQRDevice(){return a(this,void 0,void 0,(function*(){(yield this.getOrAddQRKeyring()).forgetDevice(),(yield c(this,i,"f").getAccounts()).forEach((e=>{this.setSelectedAddress(e)})),yield c(this,i,"f").persistAllKeyrings(),yield this.fullUpdate()}))}toChecksumHexAddress(e){const t=(0,g.addHexPrefix)(e);return(0,g.isHexString)(t)?(0,g.toChecksumAddress)(t):t}}t.AccountService=m,i=new WeakMap,t.default=m},8434:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9035:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ApprovalService=void 0;const i=s(3494),r=s(1239),n=s(5828),o=s(2786),a=s(2797);class d extends o.AbstractService{constructor(){super(...arguments),this.name="ApprovalService",this._approvals=new Map,this._origins=new Map,this.hub=new r.EventEmitter,this.messages=[],this.typeMessages=[]}initialize(e,t){this.updateState(Object.assign(Object.assign({},{pendingApprovals:{},pendingApprovalCount:0,unapprovedMessages:{},unapprovedMessagesCount:0,unapprovedTypeMessages:{},unapprovedTypeMessagesCount:0}),t))}_isEmptyOrigin(e){var t;return!(null===(t=this._origins.get(e))||void 0===t?void 0:t.size)}_validateAddParams(e,t,s,r){let n=null;if(e&&"string"==typeof e?this._approvals.has(e)?n=`Approval request with id '${e}' already exists.`:t&&"string"==typeof t?s&&"string"==typeof s?r&&("object"!=typeof r||Array.isArray(r))&&(n="Request data must be a plain object if specified."):n="Must specify non-empty string type.":n="Must specify non-empty string origin.":n="Must specify non-empty string id.",n)throw i.ethErrors.rpc.internal(n)}_addPendingApprovalOrigin(e,t){const s=this._origins.get(e)||new Set;s.add(t),this._origins.has(e)||this._origins.set(e,s)}_addToStore(e,t,s,i){const r={id:e,origin:t,type:s,time:Date.now(),requestData:i||null},{pendingApprovals:n}=this.getState(),o={};o[e]=r,this.updateState({pendingApprovals:Object.assign(Object.assign({},n),o),pendingApprovalCount:Object.keys(n).length+1})}_add(e,t,s,r=(0,n.v1)()){var o;if(this._validateAddParams(r,e,t,s),null===(o=this._origins.get(e))||void 0===o?void 0:o.has(t))throw i.ethErrors.rpc.resourceUnavailable(((e,t)=>`Request of type '${t}' already pending for origin ${e}. Please wait.`)(e,t));return new Promise(((i,n)=>{this._approvals.set(r,{resolve:i,reject:n}),this._addPendingApprovalOrigin(e,t),this._addToStore(r,e,t,s)}))}_delete(e){this._approvals.delete(e);const{origin:t,type:s}=this.getState().pendingApprovals[e];this._origins.get(t).delete(s),this._isEmptyOrigin(t)&&this._origins.delete(t);const{pendingApprovals:i}=this.getState();if(!i[e])return;const r=Object.assign({},i);delete r[e],this.updateState({pendingApprovals:Object.assign({},r),pendingApprovalCount:Object.keys(r).length})}_deleteApprovalAndGetCallbacks(e){const t=this._approvals.get(e);if(!t)throw new Error(`Approval request with id '${e}' not found.`);return this._delete(e),t}add(e){return this._add(e.origin,e.type,e.requestData,e.id)}get(e){return this.getState().pendingApprovals[e]}accept(e,t){this._deleteApprovalAndGetCallbacks(e).resolve(t)}reject(e,t){this._deleteApprovalAndGetCallbacks(e).reject(t)}clear(e){for(const t of this._approvals.keys())this.reject(t,e);this._origins.clear(),this.updateState({pendingApprovals:{},pendingApprovalCount:0,unapprovedMessages:{},unapprovedMessagesCount:0,unapprovedTypeMessages:{},unapprovedTypeMessagesCount:0})}getUnapprovedMessagesCount(){return Object.keys(this.getUnapprovedMessages()).length}getUnapprovedTypeMessagesCount(){return Object.keys(this.getUnapprovedTypeMessages()).length}getUnapprovedMessages(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}getUnapprovedTypeMessages(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addMessage(e){this.messages.push(e),this.saveMessageList()}addTypeMessage(e){this.typeMessages.push(e),this.saveTypeMessageList()}saveMessageList(){const e=this.getUnapprovedMessages(),t=this.getUnapprovedMessagesCount();this.updateState({unapprovedMessages:e,unapprovedMessagesCount:t}),this.hub.emit("updateBadge")}saveTypeMessageList(){const e=this.getUnapprovedTypeMessages(),t=this.getUnapprovedTypeMessagesCount();this.updateState({unapprovedTypeMessages:e,unapprovedTypeMessagesCount:t}),this.hub.emit("updateBadge")}getMessage(e){return this.messages.find((t=>t.id===e))}getTypeMessage(e){return this.typeMessages.find((t=>t.id===e))}updateMessage(e){const t=this.messages.findIndex((t=>e.id===t.id));-1!==t&&(this.messages[t]=e),this.saveMessageList()}updateTypeMessage(e){const t=this.typeMessages.findIndex((t=>e.id===t.id));-1!==t&&(this.typeMessages[t]=e),this.saveTypeMessageList()}setMessageStatus(e,t){const s=this.getMessage(e);if(!s)throw new Error(`${this.name}: Message not found for id: ${e}.`);const i=Object.assign({},s);i.status=t,this.updateMessage(i),this.hub.emit(`${e}:${t}`,i),"rejected"!==t&&"signed"!==t&&"errored"!==t||this.hub.emit(`${e}:finished`,i)}setTypeMessageStatus(e,t){const s=this.getTypeMessage(e);if(!s)throw new Error(`${this.name}: Message not found for id: ${e}.`);const i=Object.assign({},s);i.status=t,this.updateTypeMessage(i),this.hub.emit(`${e}:${t}`,i),"rejected"!==t&&"signed"!==t&&"errored"!==t||this.hub.emit(`${e}:finished`,i)}addUnapprovedMessageAsync(e,t){return new Promise(((s,i)=>{(0,a.validateSignMessageData)(e);const r=this.addUnapprovedMessage(e,t);this.hub.once(`${r}:finished`,(t=>{switch(t.status){case"signed":return s(t.rawSig);case"rejected":return i(new Error("Personal Message Signature: User denied message signature."));default:return i(new Error(`Personal Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){t&&(e.origin=t.origin),e.data=(0,a.normalizeMessageData)(e.data);const s=(0,n.v1)(),i={id:s,messageParams:e,status:"unapproved",time:Date.now(),type:"personal_sign",rawSig:""};return this.addMessage(i),this.hub.emit("unapprovedMessage",Object.assign(Object.assign({},e),{messageId:s})),s}addUnapprovedTypeMessageAsync(e,t){return new Promise(((s,i)=>{const r=this.addUnapprovedTypeMessage(e,t);this.hub.once(`${r}:finished`,(t=>{switch(t.status){case"signed":return s(t.rawSig);case"rejected":return i(new Error("Personal Message Signature: User denied message signature."));default:return i(new Error(`Personal Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedTypeMessage(e,t){t&&(e.origin=t.origin);const s=(0,n.v1)(),i={id:s,messageParams:e,status:"unapproved",time:Date.now(),type:"eth_signTypedData_v3",rawSig:""};return this.addTypeMessage(i),this.hub.emit("unapprovedMessage",Object.assign(Object.assign({},e),{messageId:s})),s}setMessageStatusSigned(e,t){const s=this.getMessage(e);s&&(s.rawSig=t,this.updateMessage(s),this.setMessageStatus(e,"signed"))}prepMessageForSigning(e){return delete e.messageId,Promise.resolve(e)}setMessageStatusApproved(e){this.setMessageStatus(e,"approved")}approveMessage(e){return this.setMessageStatusApproved(e.messageId),this.prepMessageForSigning(e)}rejectMessage(e){this.setMessageStatus(e,"rejected")}setTypeMessageStatusSigned(e,t){const s=this.getTypeMessage(e);s&&(s.rawSig=t,this.updateTypeMessage(s),this.setTypeMessageStatus(e,"signed"))}prepTypeMessageForSigning(e){return delete e.messageId,Promise.resolve(e)}setTypeMessageStatusApproved(e){this.setTypeMessageStatus(e,"approved")}approveTypeMessage(e){return this.setTypeMessageStatusApproved(e.messageId),this.prepTypeMessageForSigning(e)}rejectTypeMessage(e){this.setTypeMessageStatus(e,"rejected")}}t.ApprovalService=d,t.default=d},2797:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hexToText=t.normalizeMessageData=t.validateSignMessageData=t.isValidHexAddress=void 0;const i=s(7567),r=/^[0-9A-Fa-f]+$/gu;function n(e,{allowNonPrefixed:t=!0}={}){const s=t?(0,i.addHexPrefix)(e):e;return!!(0,i.isHexString)(s)&&(0,i.isValidAddress)(s)}t.isValidHexAddress=n,t.validateSignMessageData=function(e){const{from:t,data:s}=e;if(!t||"string"!=typeof t||!n(t))throw new Error(`Invalid "from" address: ${t} must be a valid string.`);if(!s||"string"!=typeof s)throw new Error(`Invalid message "data": ${s} must be a valid string.`)},t.normalizeMessageData=function(e){try{const t=(0,i.stripHexPrefix)(e);if(t.match(r))return(0,i.addHexPrefix)(t)}catch(e){}return(0,i.bufferToHex)(Buffer.from(e,"utf8"))},t.hexToText=function(e){try{const t=(0,i.stripHexPrefix)(e);return Buffer.from(t,"hex").toString("utf8")}catch(t){return e}}},9527:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractAdapter=void 0,t.AbstractAdapter=class{constructor(e={}){this._listeners=[],this._defaultState={},this._defaultState=e,this.initialize()}get defaultState(){return this._defaultState}get listeners(){return this._listeners}addStateListener(e){this._listeners.push(e)}removeStateListener(e){const t=this._listeners.findIndex((t=>e===t));return t>-1&&this._listeners.splice(t,1),t>-1}}},6311:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractManager=void 0,t.AbstractManager=class{constructor(){this._registers={},this._subscribers=new Map}bind(e,t){return e.adapter=t,e.manager=this,this._registers[e.name]=e,e.initialize(t.configure(),t.defaultState),e}getServiceByName(e){return this._registers[e]}getAdapterByServiceName(e){const t=this._registers[e];return t?t.adapter:null}get subscribers(){return this._subscribers}subscribe(e,t){const s=this._subscribers.get(e)||[];s.push(t),this._subscribers.set(e,s)}unsubscribe(e,t){const s=this._subscribers.get(e)||[];if(t){const i=s.findIndex((e=>t===e));i>-1&&s.splice(i,1),this._subscribers.set(e,s)}else this._subscribers.set(e,[])}}},2786:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractService=void 0;class s{constructor(){this.name="IService",this.defaultState={},this._state=this.defaultState}get manager(){return this._manager}set manager(e){this._manager=e}set adapter(e){this._adapter=e;const t=null==e?void 0:e.defaultState;t&&(this.defaultState=Object.assign(Object.assign({},this.defaultState),t)),this._state=Object.assign(Object.assign({},this._state),this.defaultState)}get adapter(){return this._adapter}getState(){return this._state}updateState(e={}){this._adapter&&(this._state=Object.assign(Object.assign({},this._state),e),this._adapter.onStateUpdate(this._state,this.name),this._adapter.listeners.forEach((e=>{e&&e(Object.assign({},this._state),this.name)})))}publish(e,t){var s;const i=null===(s=this._manager)||void 0===s?void 0:s.subscribers;if(i){const s=i.get(e);s&&s.forEach((s=>{s(e,t)}))}}}t.AbstractService=s,t.default=s},3607:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var r=Object.getOwnPropertyDescriptor(t,s);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,r)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),r=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(s(9527),t),r(s(6311),t),r(s(2786),t),r(s(6585),t),r(s(4193),t),r(s(9035),t),r(s(2797),t),r(s(8434),t),r(s(8251),t),r(s(8718),t),r(s(7021),t),r(s(473),t),r(s(7791),t),r(s(3558),t)},8251:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkService=t.NetworksChainId=void 0;const n=s(9757),o=r(s(9622)),a=r(s(8725)),d=s(2786);var c;(c=t.NetworksChainId||(t.NetworksChainId={})).rpc="",c.polygon="137",c.mumbai="80001";class u extends d.AbstractService{constructor(){super(...arguments),this.name="NetworkService",this.mutex=new n.Mutex}initialize(e){this.updateState({network:"loading"});const t={chainId:null==e?void 0:e.chainId,engineParams:{pollingInterval:12e3},nickname:null==e?void 0:e.nickname,rpcUrl:null==e?void 0:e.rpcTarget,ticker:null==e?void 0:e.ticker};this.provider=(0,a.default)(t),this.provider.on("error",this.onNetworkError.bind(this)),this.ethQuery=new o.default(this.provider),this.updateNetwork()}onNetworkError(){"loading"===this.getState().network&&this.updateNetwork()}updateNetwork(){return i(this,void 0,void 0,(function*(){if(!this.ethQuery||!this.ethQuery.sendAsync)return;const e=yield this.mutex.acquire();this.ethQuery.sendAsync({method:"net_version"},((t,s)=>{this.updateState({network:t?"loading":s}),e()}))}))}}t.NetworkService=u,t.default=u},473:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionService=t.POLYGON=void 0;const n=r(s(4809)),o=s(2786);t.POLYGON="polygon";const a=(e,t)=>{const{timeStamp:s,blockNumber:i,to:r,from:n,hash:o}=e;return{chainId:t,status:"confirmed",time:1e3*parseInt(s,10),from:n,to:r,transactionHash:o,blockNumber:i}},d=(e,s)=>{let i="api";e!==t.POLYGON&&(i="api-testnet");let r=`https://${i}.polygonscan.com/api?`;for(const e in s)s[e]&&(r+=`${e}=${s[e]}&`);return r+="tag=latest&page=1",r},c=(e,t)=>i(void 0,void 0,void 0,(function*(){const s=yield(0,n.default)(e,t);if(!s.ok)throw new Error(`Fetch failed with status '${s.status}' for request '${e}'`);return yield s.json()}));class u extends o.AbstractService{constructor(){super(...arguments),this.name="TransactionService"}initialize(){}fetchNftAll(e,t){var s,r;return i(this,void 0,void 0,(function*(){const n=null===(s=this.adapter)||void 0===s?void 0:s.configure().netWorkType,o=null===(r=this.adapter)||void 0===r?void 0:r.configure().chainId;let u="";if(n&&o){const s=yield((e,t,s)=>i(void 0,void 0,void 0,(function*(){const i={module:"account",address:t,startBlock:null==s?void 0:s.fromBlockNum,apikey:null==s?void 0:s.apiKey,order:"desc"},r=d(e,Object.assign(Object.assign({},i),{action:"token1155tx"})),n=c(r),o=d(e,Object.assign(Object.assign({},i),{action:"tokennfttx"})),a=c(o);let[u,l]=yield Promise.all([n,a]);return("0"===u.status||u.result.length<=0)&&(u={status:u.status,result:[]}),("0"===l.status||l.result.length<=0)&&(l={status:l.status,result:[]}),[u,l]})))(n,e,t),[r,l]=s,h=[...r.result.map((e=>a(e,o))),...l.result.map((e=>a(e,o)))];h.sort(((e,t)=>e.time<t.time?-1:1)),h.forEach((t=>i(this,void 0,void 0,(function*(){t.chainId===o&&t.to&&t.to.toLowerCase()===e.toLowerCase()&&t.blockNumber&&(!u||parseInt(u,10)<parseInt(t.blockNumber,10))&&(u=t.blockNumber)})))),this.updateState({transactions:h})}return u}))}}t.TransactionService=u,t.default=u},8718:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PreferencesService=void 0;const i=s(7567),r=s(2786);class n extends r.AbstractService{constructor(){super(...arguments),this.name="PreferencesService",this.defaultState={featureFlags:{},frequentRpcList:[],identities:{},ipfsGateway:"https://ipfs.io/ipfs/",lostIdentities:{},selectedAddress:"",useTokenDetection:!0,useCollectibleDetection:!1,openSeaEnabled:!1}}initialize(e,t){}addIdentities(e){const{identities:t}=this.getState();e.forEach((e=>{if(e=this.toChecksumHexAddress(e),t[e])return;const s=Object.keys(t).length;t[e]={name:`Account ${s+1}`,address:e,importTime:Date.now()}})),this.updateState({identities:Object.assign({},t)})}removeIdentity(e){e=this.toChecksumHexAddress(e);const{identities:t}=this.getState();t[e]&&(delete t[e],this.updateState({identities:Object.assign({},t)}),e===this.getState().selectedAddress&&this.updateState({selectedAddress:Object.keys(t)[0]}))}setAccountLabel(e,t){e=this.toChecksumHexAddress(e);const{identities:s}=this.getState();s[e]=s[e]||{},s[e].name=t,this.updateState({identities:Object.assign({},s)})}setFeatureFlag(e,t){const s=this.getState().featureFlags,i=Object.assign(Object.assign({},s),{[e]:t});this.updateState({featureFlags:Object.assign({},i)})}syncIdentities(e){e=e.map((e=>this.toChecksumHexAddress(e)));const{identities:t,lostIdentities:s}=this.getState(),i={};for(const s in t)-1===e.indexOf(s)&&(i[s]=t[s],delete t[s]);if(Object.keys(i).length>0)for(const e in i)s[e]=i[e];return this.updateState({identities:Object.assign({},t),lostIdentities:Object.assign({},s)}),this.addIdentities(e),-1===e.indexOf(this.getState().selectedAddress)&&this.updateState({selectedAddress:e[0]}),this.getState().selectedAddress}updateIdentities(e){const t=[],s=[],i=this.getState().identities;e.map((e=>{const r=this.toChecksumHexAddress(e);return i[r]?t.push(r):s.push(r),r}));const r=(e=t.concat(s)).reduce(((e,t,s)=>(e[t]=i[t]||{address:t,name:`Account ${s+1}`,importTime:Date.now()},e)),{});let{selectedAddress:n}=this.getState();Object.keys(r).includes(n)||(n=Object.keys(r)[0]),this.updateState({identities:Object.assign({},r),selectedAddress:n})}addToFrequentRpcList(e,t,s,i,r){const{frequentRpcList:n}=this.getState(),o=n.findIndex((({rpcUrl:t})=>t===e));-1!==o&&n.splice(o,1);const a={rpcUrl:e,chainId:t,ticker:s,nickname:i,rpcPrefs:r};n.push(a),this.updateState({frequentRpcList:[...n]})}removeFromFrequentRpcList(e){const{frequentRpcList:t}=this.getState(),s=t.findIndex((({rpcUrl:t})=>t===e));-1!==s&&t.splice(s,1),this.updateState({frequentRpcList:[...t]})}setSelectedAddress(e){this.updateState({selectedAddress:this.toChecksumHexAddress(e)})}setIpfsGateway(e){this.updateState({ipfsGateway:e})}setUseTokenDetection(e){this.updateState({useTokenDetection:e})}setUseCollectibleDetection(e){if(e&&!this.getState().openSeaEnabled)throw new Error("useCollectibleDetection cannot be enabled if openSeaEnabled is false");this.updateState({useCollectibleDetection:e})}setOpenSeaEnabled(e){this.updateState({openSeaEnabled:e}),e||this.updateState({useCollectibleDetection:!1})}toChecksumHexAddress(e){const t=(0,i.addHexPrefix)(e);return(0,i.isHexString)(t)?(0,i.toChecksumAddress)(t):t}getSelectedAddress(){return this.getState().selectedAddress}}t.PreferencesService=n,t.default=n},7791:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnectService=void 0;const r=i(s(6807)),n=s(5286);class o{constructor(e){this.walletConnector=new r.default(e)}onSessionRequest(e){this.walletConnector.on("session_request",e)}onCallRequest(e){this.walletConnector.on("call_request",e)}onDisconnect(e){this.walletConnector.on("disconnect",e)}onSessionUpdate(e){this.walletConnector.on("session_update",e)}approveRequest(e){this.walletConnector.approveRequest(e)}rejectRequest(e){this.walletConnector.rejectRequest(e)}updateSession(e){this.walletConnector.updateSession(e)}approveSession(e){this.walletConnector.approveSession(e)}rejectSession(e){this.walletConnector.rejectSession(e)}killSession(){this.walletConnector.killSession()}getSession(){return this.walletConnector.session}getConnected(){return this.walletConnector.connected}static parseWalletConnectUri(e){return(0,n.parseWalletConnectUri)(e)}}t.WalletConnectService=o,t.default=o},3558:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnectV2Service=void 0;const r=s(4814),n=s(3584);class o{constructor(e,t,s){this.projectId=e,this.relayUrl=t,this.metadata=s}createWeb3WalletClient(){return i(this,void 0,void 0,(function*(){const e={core:new r.Core({projectId:this.projectId,relayUrl:this.relayUrl}),metadata:this.metadata};this.web3Wallet=yield n.Web3Wallet.init(e)}))}getWeb3WalletClient(){return i(this,void 0,void 0,(function*(){return this.web3Wallet}))}pair(e){var t;return i(this,void 0,void 0,(function*(){return yield null===(t=this.web3Wallet)||void 0===t?void 0:t.core.pairing.pair({uri:e})}))}onSessionProposal(e){var t;null===(t=this.web3Wallet)||void 0===t||t.on("session_proposal",e)}onSessionRequest(e){var t;null===(t=this.web3Wallet)||void 0===t||t.on("session_request",e)}onSessionDelete(e){var t;null===(t=this.web3Wallet)||void 0===t||t.on("session_delete",e)}approveSession(e){var t;return i(this,void 0,void 0,(function*(){return yield null===(t=this.web3Wallet)||void 0===t?void 0:t.approveSession(e)}))}rejectSession(e){var t;return i(this,void 0,void 0,(function*(){yield null===(t=this.web3Wallet)||void 0===t?void 0:t.rejectSession(e)}))}updateSession(e){var t;return i(this,void 0,void 0,(function*(){yield null===(t=this.web3Wallet)||void 0===t?void 0:t.updateSession(e)}))}disconnectSession(e){var t;return i(this,void 0,void 0,(function*(){yield null===(t=this.web3Wallet)||void 0===t?void 0:t.disconnectSession(e)}))}respondSessionRequest(e){var t;return i(this,void 0,void 0,(function*(){yield null===(t=this.web3Wallet)||void 0===t?void 0:t.respondSessionRequest(e)}))}getActiveSessions(){var e;const t=null===(e=this.web3Wallet)||void 0===e?void 0:e.getActiveSessions();return t?Object.values(t):t}getCurrentSessionByTopic(e){const t=this.getActiveSessions();if(t&&e){const s=t.find((t=>t.topic===e)),{expiry:i}=null!=s?s:{expiry:0};if(i&&new Date(1e3*i)<new Date)return;return s}}emitSessionEvent(e){var t;return i(this,void 0,void 0,(function*(){yield null===(t=this.web3Wallet)||void 0===t?void 0:t.emitSessionEvent(e)}))}disconnectAllSessions(e){return i(this,void 0,void 0,(function*(){const t=this.getActiveSessions();t&&t.length>0&&t.forEach((t=>i(this,void 0,void 0,(function*(){const s={topic:t.topic,reason:e};yield this.disconnectSession(s)}))))}))}}t.WalletConnectV2Service=o,t.default=o},2190:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnectPort=t.WebviewPort=void 0;const i=s(1239),r=s(2035),n=s(7542);class o extends i.EventEmitter{constructor(e,t){super(),this.postMessage=(e,t="*")=>{const s=this._isMainFrame?(0,n.JS_POST_MESSAGE_TO_PROVIDER)(e,t):(0,n.JS_IFRAME_POST_MESSAGE_TO_PROVIDER)(e,t);this._window.webViewRef&&this._window.webViewRef.current&&this._window&&this._window.injectJavaScript(s)},this._window=e,this._isMainFrame=t}}t.WebviewPort=o;class a extends i.EventEmitter{constructor(e,t){super(),this.postMessage=e=>{var t,s,i,n,o,a,d,c,u,l,h,p,g,v,f,y;try{if((null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.method)===r.NOTIFICATION_NAMES.chainChanged){const t=null===(i=null===(s=this.serviceManager)||void 0===s?void 0:s.getServiceByName("PreferencesService").getSelectedAddress())||void 0===i?void 0:i.toLowerCase();null===(o=null===(n=this._wcRequestActions)||void 0===n?void 0:n.updateSession)||void 0===o||o.call(n,{chainId:parseInt(e.data.params.chainId,16),accounts:[t]})}else if((null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.method)===r.NOTIFICATION_NAMES.accountsChanged){const t=null===(c=null===(d=this.serviceManager)||void 0===d?void 0:d.getServiceByName("NetworkService").provider)||void 0===c?void 0:c.chainId;null===(l=null===(u=this._wcRequestActions)||void 0===u?void 0:u.updateSession)||void 0===l||l.call(u,{chainId:parseInt(t,10),accounts:e.data.params})}else(null===(h=null==e?void 0:e.data)||void 0===h?void 0:h.method)===r.NOTIFICATION_NAMES.unlockStateChanged||((null===(p=null==e?void 0:e.data)||void 0===p?void 0:p.error)?null===(v=null===(g=this._wcRequestActions)||void 0===g?void 0:g.rejectRequest)||void 0===v||v.call(g,{id:e.data.id,error:e.data.error}):null===(y=null===(f=this._wcRequestActions)||void 0===f?void 0:f.approveRequest)||void 0===y||y.call(f,{id:e.data.id,result:e.data.result}))}catch(e){console.warn(e)}},this._wcRequestActions=e,this.serviceManager=t}}t.WalletConnectPort=a},1706:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setupMultiplex=t.jsonStringifyStream=t.jsonParseStream=t.ConnectionStream=void 0;const r=s(871),n=i(s(9203)),o=i(s(7304)),a=s(3248),d=i(s(700)),c=()=>{};class u extends a.Duplex{constructor(e,t){super({objectMode:!0}),this._read=c,this._port=e,this._url=t,this._port.addListener("message",this._onMessage.bind(this)),this._port.addListener("disconnect",this._onDisconnect.bind(this))}_onMessage(e){if(r.Buffer.isBuffer(e)){delete e._isBuffer;const t=new r.Buffer(e);this.push(t)}else this.push(e)}_onDisconnect(){this.destroy&&this.destroy()}_write(e,t,s){try{if(r.Buffer.isBuffer(e)){const t=e.toJSON();t._isBuffer=!0,this._port.postMessage(t,this._url)}else this._port.postMessage(e,this._url)}catch(e){return s(new Error("ConnectionStream - disconnected"))}return s()}}t.default=u,t.ConnectionStream=u,t.jsonParseStream=function(){return d.default.obj((function(e,t,s){this.push(JSON.parse(e)),s()}))},t.jsonStringifyStream=function(){return d.default.obj((function(e,t,s){this.push(JSON.stringify(e)),s()}))},t.setupMultiplex=function(e){const t=new n.default;return(0,o.default)(e,t,e,(e=>{e&&console.warn(e)})),t}},2035:function(e,t){var s=this&&this.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]])}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.createLoggerMiddleware=t.createOriginMiddleware=t.NOTIFICATION_NAMES=void 0;const i=["user rejected","user denied","user cancelled"];t.NOTIFICATION_NAMES={accountsChanged:"digitalwallet_accountsChanged",unlockStateChanged:"digitalwallet_unlockStateChanged",chainChanged:"digitalwallet_chainChanged"},t.createOriginMiddleware=function(e){return function(t,s,i){t.origin=e.origin,t.params||(t.params=[]),i()}},t.createLoggerMiddleware=function(){return function(e,t,r){r((r=>{if(t.error){const{error:e}=t,r=s(t,["error"]);if(e&&!function(e,t){try{return!(!e||"string"!=typeof e||!i.some((t=>e.toLowerCase().includes(t.toLowerCase())))&&4001!==t)}catch(e){return!1}}(e.message,e.code)){let t=e;const s={message:"Error in RPC response",orginalError:e,res:r};e.message&&(t=new Error(e.message)),e.data&&(s.data=e.data,e.data.message&&(t=new Error(e.data.message)))}}e.isDigitalWalletInternal||r()}))}}},7021:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderBridge=void 0;const r=i(s(5761)),n=s(1239),o=s(8440),a=s(5198),d=i(s(7304)),c=s(4782),u=i(s(3883)),l=s(8251),h=s(2190),p=s(1706),g=s(2035);class v extends n.EventEmitter{constructor({webview:e,url:t,rpcMiddleware:s,isMainFrame:i,isWalletConnect:r,requestActions:n,getApprovedHosts:o,serviceManager:a}){var d,c,l,g,v,f,y,S,w,m;super(),this.sendStateUpdate=()=>{this.emit("update")},this.onMessage=e=>{this.port.emit("message",{name:e.name,data:e.data})},this.onDisconnect=()=>{var e,t;this.disconnected=!0,null===(e=this.serviceManager)||void 0===e||e.getServiceByName("NetworkService").adapter.removeStateListener(this.sendStateUpdate),null===(t=this.serviceManager)||void 0===t||t.getServiceByName("PreferencesService").adapter.removeStateListener(this.sendStateUpdate),this.port.emit("disconnect",{name:this.port.name,data:null})},this.url=t,this.hostname=new u.default(t).hostname,this.isMainFrame=i,this.isWalletConnect=r,this._webviewRef=e&&e.current,this.disconnected=!1,this.getApprovedHosts=o,this.rpcMiddleware=s,this.serviceManager=a;const b=null===(d=this.serviceManager)||void 0===d?void 0:d.getServiceByName("NetworkService").provider;this._providerProxy=null,this.setProvider({provider:b}),this.port=this.isWalletConnect?new h.WalletConnectPort(n,this.serviceManager):new h.WebviewPort(this._webviewRef,i),this.engine=null,this.chainIdSent=null===(l=null===(c=this.serviceManager)||void 0===c?void 0:c.getServiceByName("NetworkService").provider)||void 0===l?void 0:l.chainId,this.networkVersionSent=null===(g=this.serviceManager)||void 0===g?void 0:g.getServiceByName("NetworkService").NetworkType,this.addressSent=null===(f=null===(v=this.serviceManager)||void 0===v?void 0:v.getServiceByName("PreferencesService").getSelectedAddress())||void 0===f?void 0:f.toLowerCase();const _=new p.ConnectionStream(this.port,t),A=(0,p.setupMultiplex)(_);this.setupProviderConnection(A.createStream(r?"walletconnect-provider":"alphaUWallet-provider")),null===(y=this.serviceManager)||void 0===y||y.getServiceByName("NetworkService").adapter.addStateListener(this.sendStateUpdate),null===(S=this.serviceManager)||void 0===S||S.getServiceByName("PreferencesService").adapter.addStateListener(this.sendStateUpdate),null===(w=this.serviceManager)||void 0===w||w.getServiceByName("AccountService").onLock(this.onLock.bind(this)),null===(m=this.serviceManager)||void 0===m||m.getServiceByName("AccountService").onUnlock(this.onUnlock.bind(this)),this.on("update",this.onStateUpdate)}setProvider({provider:e}){this._providerProxy?this._providerProxy.setTarget(e):this._providerProxy=(0,c.createSwappableProxy)(e),this.provider=e}onUnlock(){this.disconnected||this.sendNotification({method:g.NOTIFICATION_NAMES.unlockStateChanged,params:!0})}onLock(){this.disconnected||this.sendNotification({method:g.NOTIFICATION_NAMES.unlockStateChanged,params:!1})}getProviderNetworkState({network:e}){var t,s,i;const r=null===(s=null===(t=this.serviceManager)||void 0===t?void 0:t.getServiceByName("NetworkService").provider)||void 0===s?void 0:s.type,n=null===(i=this.serviceManager)||void 0===i?void 0:i.getServiceByName("NetworkService").provider;let o;return r?o=l.NetworksChainId[r]:"rpc"===r&&(o=n.chainId),o&&!o.startsWith("0x")&&(o=`0x${parseInt(o,10).toString(16)}`),{networkVersion:e,chainId:o}}onStateUpdate(e){var t;const s=null===(t=this.serviceManager)||void 0===t?void 0:t.getServiceByName("NetworkService").provider;this.setProvider({provider:s}),e||(e=this.getState());const i=this.getProviderNetworkState(e);this.chainIdSent!==i.chainId&&this.networkVersionSent!==i.networkVersion&&"loading"!==i.networkVersion&&(this.chainIdSent=i.chainId,this.networkVersionSent=i.networkVersion,this.sendNotification({method:g.NOTIFICATION_NAMES.chainChanged,params:i})),this.isWalletConnect&&this.addressSent!==e.selectedAddress&&(this.addressSent=e.selectedAddress,this.sendNotification({method:g.NOTIFICATION_NAMES.accountsChanged,params:[e.selectedAddress]}))}isUnlocked(){var e;return null===(e=this.serviceManager)||void 0===e?void 0:e.getServiceByName("AccountService").isUnlocked()}getProviderState(){const e=this.getState();return Object.assign({isUnlocked:this.isUnlocked()},this.getProviderNetworkState(e))}setupProviderConnection(e){this.engine=this.setupProviderEngine();const t=(0,a.createEngineStream)({engine:this.engine});(0,d.default)(e,t,e,(e=>{this.engine._middleware.forEach((e=>{e.destroy&&"function"==typeof e.destroy&&e.destroy()})),e&&console.log("Error with provider stream conn",e)}))}setupProviderEngine(){const e=this.hostname,t=new o.JsonRpcEngine,s=this._providerProxy;return t.push((0,g.createOriginMiddleware)({origin:e})),t.push((0,g.createLoggerMiddleware)()),t.push(this.rpcMiddleware({hostname:this.hostname,getProviderState:this.getProviderState.bind(this)})),t.push((0,r.default)(s)),t}sendNotification(e){this.engine&&this.engine.emit("notification",e)}getState(){var e,t,s,i,r,n;return{isInitialized:!!(null===(t=null===(e=this.serviceManager)||void 0===e?void 0:e.getServiceByName("AccountService"))||void 0===t?void 0:t.vault),isUnlocked:!0,network:null===(i=null===(s=this.serviceManager)||void 0===s?void 0:s.getServiceByName("NetworkService").provider)||void 0===i?void 0:i.type,selectedAddress:null===(n=null===(r=this.serviceManager)||void 0===r?void 0:r.getServiceByName("PreferencesService").getSelectedAddress())||void 0===n?void 0:n.toLowerCase()}}}t.ProviderBridge=v,t.default=v},7542:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JS_IFRAME_POST_MESSAGE_TO_PROVIDER=t.JS_POST_MESSAGE_TO_PROVIDER=void 0,t.JS_POST_MESSAGE_TO_PROVIDER=(e,t)=>`(function () {\n  try {\n    window.postMessage(${JSON.stringify(e)}, '${t}');\n  } catch (e) {\n    //Nothing to do\n  }\n})()`,t.JS_IFRAME_POST_MESSAGE_TO_PROVIDER=(e,t)=>"(function () {})()"},6807:e=>{e.exports=require("@walletconnect/client")},4814:e=>{e.exports=require("@walletconnect/core")},5286:e=>{e.exports=require("@walletconnect/utils")},3584:e=>{e.exports=require("@walletconnect/web3wallet")},9757:e=>{e.exports=require("async-mutex")},871:e=>{e.exports=require("buffer")},5761:e=>{e.exports=require("eth-json-rpc-middleware/providerAsMiddleware")},267:e=>{e.exports=require("eth-keyring-controller")},9622:e=>{e.exports=require("eth-query")},3494:e=>{e.exports=require("eth-rpc-errors")},9685:e=>{e.exports=require("eth-sig-util")},7567:e=>{e.exports=require("ethereumjs-util")},3158:e=>{e.exports=require("ethereumjs-wallet")},1239:e=>{e.exports=require("events")},8440:e=>{e.exports=require("json-rpc-engine")},5198:e=>{e.exports=require("json-rpc-middleware-stream")},4809:e=>{e.exports=require("node-fetch")},9203:e=>{e.exports=require("obj-multiplex")},7304:e=>{e.exports=require("pump")},3248:e=>{e.exports=require("readable-stream")},4782:e=>{e.exports=require("swappable-obj-proxy")},700:e=>{e.exports=require("through2")},3883:e=>{e.exports=require("url-parse")},5828:e=>{e.exports=require("uuid")},8725:e=>{e.exports=require("web3-provider-engine/zero")}},t={};!function s(i){var r=t[i];if(void 0!==r)return r.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,s),n.exports}(3607)})();